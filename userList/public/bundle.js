!function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="/",e(0)}([function(t,e,n){t.exports=n(4)},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),s=n(2),l=i(s),u=l["default"].appName,c=l["default"].storage,f=function(){function t(){o(this,t),this._elems=this._getFromStorage();var e=this,n="_elems",i=this._getFromStorage(),r=i,a=function(){return r},s=function(t){i=r,r=t,this._setToStorage(t)};Object.defineProperty(e,n,{get:a,set:s,configurable:!0})}return a(t,[{key:"_getFromStorage",value:function(){return JSON.parse(c.getItem(u))||{}}},{key:"_setToStorage",value:function(t){c.setItem(u,JSON.stringify(t))}},{key:"isExist",value:function(t){return!!this._elems[t]}},{key:"addItem",value:function(t){var e=t.login;return t.registered_on=Date.now(),t.age=Number(t.age),t.role=Number(t.role),this._elems=Object.assign(this._elems,r({},e,Object.assign({},t))),t}},{key:"getItem",value:function(t){return this._elems[t]?this._elems[t]:"Item not found!"}},{key:"updateItem",value:function(t){var e=this._elems[t.login];t.age=Number(t.age),t.role=Number(t.role),t.registered_on=e.registered_on;for(var n in e)e.hasOwnProperty(n)&&(e[n]=t[n]);return this._elems=Object.assign(this._elems,this._elems),this._elems[t.login]}},{key:"deleteItem",value:function(t){var e="string"==typeof t?t:t.login,n=delete this._elems[e];return this._elems=Object.assign(this._elems,this._elems),n}},{key:"forEach",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?this._elems:arguments[1];for(var n in e)e.hasOwnProperty(n)&&t.call(e,e[n],n,e)}},{key:"map",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?this._elems:arguments[1],n={};for(var i in e)e.hasOwnProperty(i)&&(n[i]=t.call(e,e[i],i,e));return n}},{key:"sort",value:function(t){function e(t,e){var n=t.login.toLowerCase(),i=e.login.toLowerCase();return n<i?-1:n>i?1:0}var n={},i=[];t=t||e;for(var r in this._elems)this._elems.hasOwnProperty(r)&&i.push(this._elems[r]);return i.sort(t),i.forEach(function(t){n[t.login]=t}),n}}]),t}();e["default"]=f},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={appName:"userList"};"undefined"==typeof localStorage||null===localStorage?!function(){var t={};n.storage={getItem:function(e){var n=t[e]||{};return JSON.stringify(n)},setItem:function(e,n){t[e]=n}},console.warn("WARNING!\n   LocalStorage is emulated!\n    Run on Node Environment!")}():n.storage=localStorage,e["default"]=n},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),o=function(){function t(e){if(n(this,t),this.formEl=document.querySelector(e),!this.formEl)throw new Error("Incorrect selector for FORM element!");this.setDataToHtml=this.setDataToHtml.bind(this)}return r(t,[{key:"getDataFromHtml",value:function(t){function e(e){e.preventDefault();for(var r in this.elements)if(this.elements.hasOwnProperty(r)&&n.hasOwnProperty(r))switch(this.elements[r].type){case"radio":1==inputsArr[i].checked&&(n[r]=this.elements[r].value);break;case"checkbox":n[r]=this.elements[r].checked;break;default:n[r]=this.elements[r].value}t(Object.assign({},n))}this.form.formEl.addEventListener("submit",e,!1);var n={first_name:"",last_name:"",active:"",age:"",login:"",password:"",role:""}}},{key:"reset",value:function(){for(var t in this.formEl.elements)this.formEl.elements.hasOwnProperty(t)&&(this.formEl.elements[t].value="")}},{key:"setDataToHtml",value:function(t){for(var e in t)t.hasOwnProperty(e)&&this.formEl.elements.hasOwnProperty(e)&&(this.formEl.elements[e].checked=this.formEl.elements[e].value=t[e])}}]),t}();e["default"]=o},function(t,e,n){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),a=n(1),s=i(a),l=n(3),u=i(l),c=n(6),f=i(c),d=n(5),h=i(d),m=n(7),v=i(m),g=function(){function t(){r(this,t),this.tableHandler=this.tableHandler.bind(this),this.validate=this.validate.bind(this),this.editUser=this.editUser.bind(this),this.collection=new s["default"],this.validator=new v["default"],this.table=new f["default"]("[data-app-list]",this.collection,this.tableHandler),this.form=new u["default"]("[data-app-form]"),this.notificator=new h["default"](this.form)}return o(t,[{key:"init",value:function(){this.form.getDataFromHtml.call(this,this.validate),this.table.sort("active","ASC")}},{key:"validate",value:function(t){var e=this;return this.validator.validate(t),this.validator.hasErrors(t)?(console.error(this.validator.messages.join("\n")),this.validator.messages.forEach(function(t){e.notificator.showCustomNotification(t,"danger")}),!1):(t.isValid=!0,this.addToCollection(t),void this.form.reset())}},{key:"addToCollection",value:function(t){if(!t.isValid)return!1;var e=void 0;return this.collection.isExist(t.login)?(e=this.collection.updateItem(t),this.notificator.showNotification("update",t,"success"),this.table.update(e)):(e=this.collection.addItem(t),this.notificator.showNotification("add",t,"success"),this.table.add(e)),e}},{key:"deleteFromCollection",value:function(t){return this.collection.isExist(t)&&this.collection.deleteItem(t),!1}},{key:"editUser",value:function(t){var e=this.collection.getItem(t);this.form.setDataToHtml(e)}},{key:"tableHandler",value:function(t){if(t.target.dataset.appSort){var e=t.target.dataset.appSort;this.table.sort(e,this.table.sortOrder),this.table.sortOrder="ASC"===this.table.sortOrder?"DESC":"ASC"}t.target.dataset.appDelete&&(this.deleteFromCollection(t.target.dataset.appDelete),this.table["delete"](t.target.dataset.appDelete)),t.target.dataset.appEdit&&this.editUser(t.target.dataset.appEdit)}}]),t}();!function(){var t=new g;t.init()}(),e["default"]=g},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e,i){n(this,t);var r={update:"User $login was updated",add:"User $login was added"};this.notifications=Object.assign(r,i),this.showNotification=this.showNotification.bind(this),this.showCustomNotification=this.showCustomNotification.bind(this),this.form=e,this.timeoutId}return i(t,[{key:"showCustomNotification",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?"warning":arguments[1],n='\n      <div class="alert alert-'+e+' alert-dismissible" role="alert">\n          <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n          <strong>'+("danger"==e?"Error!":"")+"</strong> "+t+"\n      </div>";this._insertHtml(n)}},{key:"showNotification",value:function(t,e){var n=arguments.length<=2||void 0===arguments[2]?"warning":arguments[2],i='\n      <div class="alert alert-'+n+' alert-dismissible" role="alert">\n          <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n          <strong>'+("danger"==n?"Error!":"")+"</strong> "+this.notifications[t].replace("$login",e.login)+"\n      </div>";this._insertHtml(i)}},{key:"_insertHtml",value:function(t){this.form.formEl.insertAdjacentHTML("afterBegin",t),this._closeNotification()}},{key:"_closeNotification",value:function(){var t=this;this.timeoutId||(this.timeoutId=setTimeout(function(){$(".alert").alert("close"),t.timeoutId=!1},5e3))}}]),t}();e["default"]=r},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e,i,r){if(n(this,t),this.tableEl=document.querySelector(e),!this.tableEl)throw new Error("Incorrect selector for TABLE element!");this.tableEl.addEventListener("click",r,!1),this.sortOrder="ASC",this.collection=i}return i(t,[{key:"add",value:function(t){$(this.tableEl).find("tbody").append(this._getRowStr(t))}},{key:"init",value:function(){var t=this,e=arguments.length<=0||void 0===arguments[0]?this.collection._elems:arguments[0];$(this.tableEl).find("tbody").empty(),this.collection.forEach(function(e){$(t.tableEl).find("tbody").append(t._getRowStr(e))},e)}},{key:"sort",value:function(t,e){function n(n,r){var o=void 0,a=void 0;return n.active===r.active?(n[t]="string"==typeof n[t]?n[t].toLowerCase():n[t],r[t]="string"==typeof r[t]?r[t].toLowerCase():r[t],"ASC"===e?(o=n[t],a=r[t]):(a=n[t],o=r[t]),"role"===t&&(o=i._getUserRoleName(o),a=i._getUserRoleName(a)),o<a?-1:o>a?1:0):n.active<r.active?1:-1}var i=this;this.init(this.collection.sort(n))}},{key:"update",value:function(t){$(this.tableEl).find("tbody tr[data-app-userId="+t.login+"]").replaceWith(this._getRowStr(t))}},{key:"delete",value:function(t){$(this.tableEl).find("tbody tr[data-app-userId="+t+"]").remove()}},{key:"_getRowStr",value:function(t){var e=new Date(t.registered_on),n=this._getUserRoleName(t.role);return"<tr data-app-userId="+t.login+">\n          <td>"+n+"</td>\n          <td>"+t.login+"</td>\n          <td>"+t.first_name+" "+t.last_name+"</td>\n          <td>"+t.age+"</td>\n          <td>"+e.toLocaleDateString()+"</td>\n          <td>"+t.active+'</td>\n          <td><button type="button" class="btn btn-primary" data-app-edit='+t.login+'>Редактировать</button></td>\n          <td><button type="button" class="btn btn-danger" data-app-delete='+t.login+">Удалить</button></td>\n      </tr>"}},{key:"_getUserRoleName",value:function(t){var e=void 0;switch(t){case 1:e="Administrator";break;case 2:e="Technician";break;case 3:e="Manager";break;case 4:e="Supervisor";break;default:e="Anonimus"}return e}}]),t}();e["default"]=r},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),r=function(){function t(e){n(this,t);var i={first_name:{type:"isString3to15",instruction:"The string should contain from 3 to 15 symbols"},last_name:{type:"isString3to25",instruction:"The string should contain from 3 to 25 symbols"},active:{type:"isBool",instruction:"The value must be a Boolean type"},age:{type:"isAgeInRange",instructions:"The age is not included in the range from 18 to 55"},login:{type:"isAlphaNumFrom3",instruction:"The string should contain minimum 3 symbols"},password:{type:"isStringFrom8",instruction:"The string should contain minimum 8 symbols"},role:{type:"isRole",instruction:"The value should be: Administrator, Technician, Manager, Supervisor"}};this.messages=[],this.config=Object.assign(i,e||{}),this.types=this.types.call(this)}return i(t,[{key:"validate",value:function(t){var e=void 0,n=void 0,i=void 0,r=void 0,o=void 0;this.messages=[];for(e in t)if(t.hasOwnProperty(e)&&this.config.hasOwnProperty(e)){if(i=this.config[e].type,r=this.types[i],!i)continue;if(!r)throw{name:"ValidationError",message:"No handler to validate type "+i};o=r.validate(t[e]),o||(n="Invalid value for * "+e+" *, "+this.config[e].instruction,this.messages.push(n))}}},{key:"hasErrors",value:function(){return 0!==this.messages.length}},{key:"types",value:function(){var t={validate:function(t){return"boolean"==typeof t}},e={validate:function(t){return 17<t&&t<56}},n={validate:function(t){return"string"==typeof t&&3<t.length&&t.length<15}},i={validate:function(t){return"string"==typeof t&&3<t.length&&t.length<25}},r={validate:function(t){return/^[a-z0-9_-]{3,}$/g.test(t)}},o={validate:function(t){return"string"==typeof t&&t.length>7}},a={validate:function(t){return 0<t&&t<5}},s={validate:function(t){var e=Object.prototype.toString;return"[object Date]"==e.call(t)}};return{isString3to15:n,isString3to25:i,isBool:t,isAgeInRange:e,isAlphaNumFrom3:r,isStringFrom8:o,isRole:a,isDate:s}}}]),t}();e["default"]=r}]);
//# sourceMappingURL=bundle.js.map